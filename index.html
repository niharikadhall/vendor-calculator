<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supplier Sustainability Calculator</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 40px;
            color: #333;
        }

        h1 {
            font-size: 2.5em;
            font-weight: bold;
            color: #2E7D32;
        }

        label {
            display: block;
            font-size: 1em;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
        }

        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            color: #333;
            background-color: #f9f9f9;
            margin-bottom: 15px;
        }

        button {
            background-color: #2E7D32;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            display: block;
            margin: 20px auto;
        }

        button:hover {
            background-color: #1B5E20;
        }

        #results {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .result-item {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Supplier Sustainability Calculator</h1>

    <div>
        <label>Supplier Name:</label>
        <input type="text" id="supplier-name" placeholder="e.g., Supplier A">
    </div>
    <div>
        <label>Energy Consumption (kWh):</label>
        <input type="number" id="energy" placeholder="e.g., 4000">
    </div>
    <div>
        <label>Materials (%):</label>
        <input type="number" id="materials" placeholder="e.g., 60">
    </div>
    <div>
        <label>Transportation Emissions (kg CO2):</label>
        <input type="number" id="transport" placeholder="e.g., 100">
    </div>
    <div>
        <label>Waste Generated (kg):</label>
        <input type="number" id="waste" placeholder="e.g., 200">
    </div>

    <button onclick="calculateScores()">Calculate & Save</button>

    <div id="results">
        <h3>Results</h3>
        <div id="eei-result" class="result-item"></div>
        <div id="sss-result" class="result-item"></div>
        <div id="final-result" class="result-item"></div>
    </div>

    <script>
        // Google Apps Script Web App URL
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz0M3EOTiZjyugg7OlTb50ell1QYXDtbRRTIjnG6WIU3PH-DyMWQK4wOm6K23hA8wIG/exec';

        async function saveDataToGoogleSheet(data) {
            try {
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        sheetName: 'SupplierData', // Change to your actual sheet name
                        data: data
                    })
                });

                const result = await response.json();
                if (result.status === 'success') {
                    alert('Data saved successfully!');
                } else {
                    alert('Error: ' + result.message);
                }
            } catch (error) {
                console.error('Error saving data:', error);
                alert('There was an error saving the data.');
            }
        }

        function calculateScores() {
            // Collect input values
            const supplierName = document.getElementById('supplier-name').value.trim();
            const energy = parseFloat(document.getElementById('energy').value) || 0;
            const materials = parseFloat(document.getElementById('materials').value) || 0;
            const transport = parseFloat(document.getElementById('transport').value) || 0;
            const waste = parseFloat(document.getElementById('waste').value) || 0;

            // Validate inputs
            if (!supplierName) {
                alert('Please enter a supplier name.');
                return;
            }

            // Calculate EEI and SSS
            const eei = (energy * 0.4) + (materials * 0.3) + (transport * 0.2) + (waste * 0.1);
            const sss = (energy + materials + transport + waste) / 4;

            // Prepare data to save
            const data = [
                supplierName,
                energy,
                materials,
                transport,
                waste,
                eei,
                sss
            ];

            // Save data to Google Sheets using Google Apps Script
            saveDataToGoogleSheet(data);

            // Display Results
            document.getElementById('eei-result').innerText = `EEI: ${eei.toFixed(2)}`;
            document.getElementById('sss-result').innerText = `SSS: ${sss.toFixed(2)}`;
            document.getElementById('final-result').innerText = `Final Score: ${(eei + sss) / 2}`;
            document.getElementById('results').style.display = 'block';
        }
    </script>
</body>
</html>
